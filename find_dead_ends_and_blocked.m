function [results]=find_dead_ends_and_blocked(model)

    % a formalised test-suite for validating yeast models. reliant on the
    % cobra toolbox. This function tests using a minimal medium with
    % glucose as the carbon source.
    %
    % Input:
    %   model     A COBRA Toolbox-format yeast model. Currently supports:
    %              iFF708 - doi: 10.1101/gr.234503
    %              iND750 - doi: 10.1101/gr.2250904
    %              iIN800 - doi: 10.1186/1752-0509-2-71
    %              iMM904 - doi: 10.1186/1752-0509-3-37
    %              Yeast 4 - doi: 10.1186/1752-0509-4-145
    %              iAZ900 - doi: 10.1186/1752-0509-4-178
    %              iMM904bz - doi: 10.1038/ng.846
    %              Yeast 5 - doi:10.1186/1752-0509-6-55
    %              iTO977 - doi:10.1186/1752-0509-7-36
    %              Yeast 6 - doi:10.1093/database/bat059
    %
    % Output:
    %
    %   results   a structure containing lists of dead end metabolites in
    %               the model, and blocked reactions using the model
    %               default and iFF708 biomass definitions.

    %% citation
    % based on testYeastmodel code by kieran smallbone and ben heavner,
    % doi: 10.1186/1752-0509-6-55
    %
    % please cite: Heavner, Benjamin D. and Nathan Price. “Comparing Yeast
    % Metabolic Network Reconstructions” NEED TO ADD CITATION DETAILS

    %% check whether we can use the model
    switch lower(model.description)
        case {'iff708_valid_modified.xml'} 
            fprintf('\nSetting iFF708 model objective function.\n');
            
            model.c(1368) = 0; % the SBML file has two objectives set
            
        case {'ind750.xml'}
            
        case {'imm904'}
            
        case {'iaz900.xml'}
           
        case {'yeast_4.05'}
            
        case {'yeast_5.01_model.xml'}
            
        case {'yeast_6.06_cobra'}
            
        case {'ito977_cobra_compatible'}
            
        case {'imm904_nadcorrected'}
 
        case {'iin800_cobra'}
            fprintf('\nSetting iIN800 model objective function.\n\n');
            model.c(findRxnIDs(model,'GROWTH')) = 1; % set growth objective
            
            fprintf('\nAdding TAG and phosphatidate exchanges.\n\n');
            
            model = addExchangeRxn(model,{'m758'},-1000,0);
            model = addExchangeRxn(model,{'m928'},-1000,0);
            
        case {'iin800.xml'}
            
        otherwise
            error('Sorry, this model is not currently supported.')
            
    end

    %% modify biomass def
    % changing the biomass def can alter which reactions are blocked. For
    % comparing models, a common biomass definition (that of iFF708) may be
    % helpful.

    switch lower(model.description)
        case {'iff708_valid_modified.xml'}
            changed_model = model;

        case {'ind750.xml'}
            changed_model=changeRxnMets(model,...
                {'13BDglcn[c]';'ala-L[c]';'amp[c]';'arg-L[c]';...
                'asn-L[c]';'asp-L[c]';'atp[c]';'cmp[c]';'cys-L[c]';...
                'damp[c]';'dcmp[c]';'dgmp[c]';'dtmp[c]';'ergst[c]';...
                'gln-L[c]';'glu-L[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
                'h2o[c]';'his-L[c]';'ile-L[c]';'leu-L[c]';'lys-L[c]';...
                'mannan[c]';'met-L[c]';'pa_SC[c]';'pc_SC[c]';...
                'pe_SC[c]';'phe-L[c]';'pro-L[c]';'ps_SC[c]';...
                'ptd1ino_SC[c]';'ser-L[c]';'so4[c]';...
                'thr-L[c]';'tre[c]';'triglyc_SC[c]';'trp-L[c]';...
                'tyr-L[c]';'ump[c]';'val-L[c]';'zymst[c]';'adp[c]';...
                'h[c]';'pi[c]';}, ... %mets to change
                {'13BDglcn[c]';'ptd1ino_SC[c]';'tre[c]';'amp[c]';...
                'atp[c]';'cmp[c]';'damp[c]';'dcmp[c]';'dgmp[c]';...
                'dtmp[c]';'ergst[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
                'ala-L[c]';'arg-L[c]';'asn-L[c]';'asp-L[c]';'cys-L[c]';...
                'glu-L[c]';'gln-L[c]';'his-L[c]';'ile-L[c]';'leu-L[c]';...
                'lys-L[c]';'met-L[c]';'phe-L[c]';'pro-L[c]';'ser-L[c]';...
                'thr-L[c]';'trp-L[c]';'tyr-L[c]';'val-L[c]';...
                'mannan[c]';'pa_SC[c]';'pc_SC[c]';'pe_SC[c]';...
                'ps_SC[c]';'so4[c]';'triglyc_SC[c]';'ump[c]';...
                'zymst[c]';'adp[c]';'pi[c]';}, ... %new mets
                {'biomass_SC4_bal';}, ... %rxn id
                [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
                -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
                -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
                -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
                -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
                -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
                -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
                59.276;59.305;]); %stoichiometric coefficients
            
        case {'iin800_cobra'}
            changed_model=changeRxnMets(model,...
                {'m29';'m241';'m253';'m262';'m316';'m365';'m370';...
                'm391';'m413';'m483';'m485';'m490';'m554';'m557';...
                'm559';'m562';'m569';'m575';'m578';'m583';'m588';...
                'm593';'m597';'m601';'m606';'m609';'m613';'m616';...
                'm620';'m624';'m627';'m633';'m648';'m864';'m966';...
                'm230';'m272';'m733';}, ... %mets to change
                {'m29';'m38';'m241';'m253';'m262';'m316';'m365';...
                'm370';'m391';'m413';'m429';'m483';'m485';'m490';...
                'm554';'m557';'m559';'m562';'m569';'m575';'m578';...
                'm583';'m588';'m593';'m597';'m601';'m606';'m609';...
                'm613';'m616';'m620';'m624';'m627';'m648';'m757';...
                'm761';'m762';'m766';'m864';'m928';'m966';'m984';...
                'm230';'m272';'m733';}, ... %new mets
                {'CBIOMASS';}, ... %rxn id
                [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
                -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
                -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
                -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
                -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
                -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
                -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
                59.276;1;59.305;]); %stoichiometric coefficients

        case {'iin800.xml'}
            % note: iIN800 doesn't include the species "phosphatidate",
            % so not an exact iFF biomass deff
            changed_model = changeRxnMets(model, ...
                {'1,3-beta-D-glucan [c]';...
                'alpha,alpha-trehalose [c]';'AMP [c]';'ATP [c]';...
                'CMP [c]';'dAMP [c]';'dCMP [c]';'dGMP [c]';...
                'dTMP [c]';'glycine [c]';'glycogen [c]';...
                'GMP [c]';'L-alanine [c]';'L-arginine [c]';...
                'L-asparagine [c]';'L-aspartate [c]';...
                'L-cysteine [c]';'L-glutamate [c]';...
                'L-glutamine [c]';'L-histidine [c]';...
                'L-isoleucine [c]';'L-leucine [c]';...
                'L-lysine [c]';'L-methionine [c]';...
                'L-phenylalanine [c]';'L-proline [c]';...
                'L-serine [c]';'L-threonine [c]';...
                'L-tryptophan [c]';'L-tyrosine [c]';...
                'L-valine [c]';'lipids [c]';'mannan [c]';...
                'sulfate [c]';'UMP [c]';'ADP [c]';'biomass [c]';...
                'phosphate [c]'}, ... %mets to change
                {'1,3-beta-D-glucan [c]';...
                '1-phosphatidyl-1D-myo-inositols [c]';...
                'alpha,alpha-trehalose [c]';'AMP [c]';'ATP [c]';...
                'CMP [c]';'dAMP [c]';'dCMP [c]';'dGMP [c]';...
                'dTMP [c]';'ergosterol [c]';'glycine [c]';...
                'glycogen [c]';'GMP [c]';'L-alanine [c]';...
                'L-arginine [c]';'L-asparagine [c]';...
                'L-aspartate [c]';'L-cysteine [c]';...
                'L-glutamate [c]';'L-glutamine [c]';...
                'L-histidine [c]';'L-isoleucine [c]';...
                'L-leucine [c]';'L-lysine [c]';'L-methionine [c]';...
                'L-phenylalanine [c]';'L-proline [c]';...
                'L-serine [c]';'L-threonine [c]';...
                'L-tryptophan [c]';'L-tyrosine [c]';...
                'L-valine [c]';'mannan [c]';...
                'phosphatidylcholines [c]';...
                'phosphatidylethanolamines [c]';...
                'phosphatidylserine [c]';'sulfate [c]';...
                'triglycerides [c]';'UMP [c]';'zymosterol [c]';...
                'ADP [c]';'biomass [c]';'phosphate [c]'}, ... %new mets
                {'CBIOMASS';}, ... %rxn id
                [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
                -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
                -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
                -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
                -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
                -0.0284;-0.102;-0.2646;-0.8079;-0.0006;...
                -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
                59.276;1;59.305;]); %stoichiometric coefficients

        case {'imm904'}
            changed_model=changeRxnMets(model,...
                {'13BDglcn[c]';'ala-L[c]';'amp[c]';'arg-L[c]';...
                'asn-L[c]';'asp-L[c]';'atp[c]';'cmp[c]';'cys-L[c]';...
                'damp[c]';'dcmp[c]';'dgmp[c]';'dtmp[c]';'ergst[c]';...
                'gln-L[c]';'glu-L[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
                'h2o[c]';'his-L[c]';'ile-L[c]';'leu-L[c]';'lys-L[c]';...
                'mannan[c]';'met-L[c]';'pa_SC[c]';'pc_SC[c]';...
                'pe_SC[c]';'phe-L[c]';'pro-L[c]';'ps_SC[c]';...
                'ptd1ino_SC[c]';'ribflv[c]';'ser-L[c]';'so4[c]';...
                'thr-L[c]';'tre[c]';'triglyc_SC[c]';'trp-L[c]';...
                'tyr-L[c]';'ump[c]';'val-L[c]';'zymst[c]';'adp[c]';...
                'h[c]';'pi[c]';}, ... %mets to change
                {'13BDglcn[c]';'ptd1ino_SC[c]';'tre[c]';'amp[c]';...
                'atp[c]';'cmp[c]';'damp[c]';'dcmp[c]';'dgmp[c]';...
                'dtmp[c]';'ergst[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
                'ala-L[c]';'arg-L[c]';'asn-L[c]';'asp-L[c]';'cys-L[c]';...
                'glu-L[c]';'gln-L[c]';'his-L[c]';'ile-L[c]';'leu-L[c]';...
                'lys-L[c]';'met-L[c]';'phe-L[c]';'pro-L[c]';'ser-L[c]';...
                'thr-L[c]';'trp-L[c]';'tyr-L[c]';'val-L[c]';...
                'mannan[c]';'pa_SC[c]';'pc_SC[c]';'pe_SC[c]';...
                'ps_SC[c]';'so4[c]';'triglyc_SC[c]';'ump[c]';...
                'zymst[c]';'adp[c]';'pi[c]';}, ... %new mets 
                {'biomass_SC5_notrace';}, ... %rxn id
                [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
                -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
                -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
                -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
                -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
                -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
                -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
                59.276;59.305;]); %stoichiometric coefficients

        case {'iaz900.xml'}
            changed_model=changeRxnMets(model,...
                {'13BDglcn[c]';'16BDglcn[c]';'alatrna[c]';'amp[c]';...
                'argtrna[c]';'asntrna[c]';'asptrna[c]';'atp[c]';...
                'cmp[c]';'cystrna[c]';'damp[c]';'dcmp[c]';'dgmp[c]';...
                'dtmp[c]';'glntrna[c]';'glutrna[c]';'glycogen[c]';...
                'glytrna[c]';'gmp[c]';'h2o[c]';'histrna[c]';...
                'iletrna[c]';'leutrna[c]';'lystrna[c]';'mannan[c]';...
                'mettrna[c]';'pa_SC[c]';'pe_SC[c]';'phetrna[c]';...
                'phospholipid[c]';'protrna[c]';'ps_SC[c]';...
                'ptd1ino_SC[c]';'ribflv[c]';'sertrna[c]';'so4[c]';...
                'sterol[c]';'thrtrna[c]';'tre[c]';'triglyc_SC[c]';...
                'trptrna[c]';'tyrtrna[c]';'ump[c]';'valtrna[c]';...
                'zymst[c]';'adp[c]';'h[c]';'pi[c]';'trnaala[c]';...
                'trnaarg[c]';'trnaasn[c]';'trnaasp[c]';'trnacys[c]';...
                'trnagln[c]';'trnaglu[c]';'trnagly[c]';'trnahis[c]';...
                'trnaile[c]';'trnaleu[c]';'trnalys[c]';'trnamet[c]';...
                'trnaphe[c]';'trnapro[c]';'trnaser[c]';'trnathr[c]';...
                'trnatrp[c]';'trnatyr[c]';'trnaval[c]';}, ... %mets to change
                {'13BDglcn[c]';'ptd1ino_SC[c]';'tre[c]';'amp[c]';...
                'atp[c]';'cmp[c]';'damp[c]';'dcmp[c]';'dgmp[c]';...
                'dtmp[c]';'ergst[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
                'ala_L[c]';'arg_L[c]';'asn_L[c]';'asp_L[c]';'cys_L[c]';...
                'glu_L[c]';'gln_L[c]';'his_L[c]';'ile_L[c]';'leu_L[c]';...
                'lys_L[c]';'met_L[c]';'phe_L[c]';'pro_L[c]';'ser_L[c]';...
                'thr_L[c]';'trp_L[c]';'tyr_L[c]';'val_L[c]';...
                'mannan[c]';'pa_SC[c]';'pc_SC[c]';'pe_SC[c]';...
                'ps_SC[c]';'so4[c]';'triglyc_SC[c]';'ump[c]';...
                'zymst[c]';'adp[c]';'pi[c]';}, ... %new mets
                {'biomass_wild';}, ... %rxn id
                [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
                -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
                -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
                -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
                -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
                -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
                -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
                59.276;59.305;]); %stoichiometric coefficients

        case {'yeast_4.05'}
            changed_model=changeRxnMets(model,...
                {'s_0002';'s_0416';'s_0434';'s_0446';'s_0511';...
                's_0564';'s_0569';'s_0593';'s_0619';'s_0740';'s_0743';...
                's_0752';'s_0863';'s_0873';'s_0877';'s_0881';'s_0889';...
                's_0899';'s_0907';'s_0911';'s_0920';'s_0925';'s_0929';...
                's_0933';'s_0936';'s_0939';'s_0943';'s_0949';'s_0952';...
                's_0955';'s_0960';'s_1000';'s_1011';'s_1283';'s_1347';...
                's_1417';'s_0400';'s_0463';'s_1207';}, ... %mets to change
                {'s_0002';'s_0091';'s_0416';'s_0434';'s_0446';...
                's_0511';'s_0564';'s_0569';'s_0593';'s_0619';'s_0636';...
                's_0740';'s_0743';'s_0752';'s_0863';'s_0873';'s_0877';...
                's_0881';'s_0889';'s_0899';'s_0907';'s_0911';'s_0920';...
                's_0925';'s_0929';'s_0933';'s_0936';'s_0939';'s_0943';...
                's_0949';'s_0952';'s_0955';'s_0960';'s_1011';'s_1216';...
                's_1229';'s_1234';'s_1220';'s_1347';'s_1399';'s_1417';...
                's_1448';'s_0400';'s_0463';'s_1207';}, ... %new mets
                {'r_1812';}, ... %rxn id
                [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
                -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
                -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
                -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
                -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
                -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
                -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
                59.276;1;59.305;]); %stoichiometric coefficients

        case {'yeast_5.01_model.xml'}
            changed_model=changeRxnMets(model,...
                {'s_0002';'s_0423';'s_0434';'s_0526';'s_0584';...
                's_0589';'s_0615';'s_0649';'s_0773';'s_0782';'s_0803';...
                's_0955';'s_0965';'s_0969';'s_0973';'s_0981';'s_0991';...
                's_0999';'s_1003';'s_1006';'s_1016';'s_1021';'s_1025';...
                's_1029';'s_1032';'s_1035';'s_1039';'s_1045';'s_1048';...
                's_1051';'s_1056';'s_1096';'s_1107';'s_1405';'s_1467';...
                's_1520';'s_1545';'s_0394';'s_0450';'s_0794';...
                's_1322';}, ... %mets to change
                {'s_0002';'s_0089';'s_1520';'s_0423';'s_0434';...
                's_0526';'s_0584';'s_0589';'s_0615';'s_0649';'s_0666';...
                's_1003';'s_0773';'s_0782';'s_0955';'s_0965';'s_0969';...
                's_0973';'s_0981';'s_0991';'s_0999';'s_1006';'s_1016';...
                's_1021';'s_1025';'s_1029';'s_1032';'s_1035';'s_1039';...
                's_1045';'s_1048';'s_1051';'s_1056';'s_1107';'s_1331';...
                's_1346';'s_1351';'s_1337';'s_1467';'s_1524';'s_1545';...
                's_1569';'s_0394';'s_0450';'s_1322';}, ... %new mets
                {'r_2110';}, ... %rxn id
                [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
                -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
                -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
                -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
                -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
                -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
                -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
                59.276;1;59.305;]); %stoichiometric coefficients

        case {'yeast_6.06_cobra'}
            changed_model=changeRxnMets(model,...
                {'s_0002';'s_0423';'s_0434';'s_0526';'s_0584';...
                's_0589';'s_0615';'s_0649';'s_0773';'s_0782';'s_0803';...
                's_0955';'s_0965';'s_0969';'s_0973';'s_0981';'s_0991';...
                's_0999';'s_1003';'s_1006';'s_1016';'s_1021';'s_1025';...
                's_1029';'s_1032';'s_1035';'s_1039';'s_1045';'s_1048';...
                's_1051';'s_1056';'s_1096';'s_1107';'s_1405';'s_1467';...
                's_1520';'s_1545';'s_0394';'s_0450';'s_0794';...
                's_1322';}, ... %mets to change
                {'s_0002';'s_0089';'s_1520';'s_0423';'s_0434';...
                's_0526';'s_0584';'s_0589';'s_0615';'s_0649';'s_0666';...
                's_1003';'s_0773';'s_0782';'s_0955';'s_0965';'s_0969';...
                's_0973';'s_0981';'s_0991';'s_0999';'s_1006';'s_1016';...
                's_1021';'s_1025';'s_1029';'s_1032';'s_1035';'s_1039';...
                's_1045';'s_1048';'s_1051';'s_1056';'s_1107';'s_1331';...
                's_1346';'s_1351';'s_1337';'s_1467';'s_1524';'s_1545';...
                's_1569';'s_0394';'s_0450';'s_1322';}, ... %new mets
                {'r_2133';}, ... %rxn id
                [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
                -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
                -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
                -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
                -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
                -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
                -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
                59.276;1;59.305;]); %stoichiometric coefficients

        case {'imm904_nadcorrected'}
            changed_model=changeRxnMets(model,...
                {'13BDglcn[c]';'ala_L[c]';'amp[c]';'arg_L[c]';...
                'asn_L[c]';'asp_L[c]';'atp[c]';'camp[c]';...
                'chitin[c]';'cmp[c]';'coa[c]';'cys_L[c]';...
                'damp[c]';'dcmp[c]';'dgmp[c]';'dtmp[c]';'ergst[c]';...
                'fad[c]';'gln_L[c]';'glu_L[c]';'gly[c]';...
                'glycogen[c]';'gmp[c]';'gthrd[c]';'h2o[c]';...
                'his_L[c]';'ile_L[c]';'leu_L[c]';'lys_L[c]';...
                'mannan[c]';'met_L[c]';'nad[c]';'pa_SC[c]';...
                'pc_SC[c]';'pe_SC[c]';'phe_L[c]';'pheme[m]';...
                'pro_L[c]';'ps_SC[c]';'ptd1ino_SC[c]';'q6[m]';...
                'ribflv[c]';'ser_L[c]';'so4[c]';'thf[c]';...
                'thmtp[c]';'thr_L[c]';'tre[c]';'triglyc_SC[c]';'trp_L[c]';...
                'tyr_L[c]';'ump[c]';'val_L[c]';'zymst[c]';'adp[c]';...
                'h[c]';'pi[c]';}, ... %mets to change
                {'13BDglcn[c]';'ptd1ino_SC[c]';'tre[c]';'amp[c]';...
                'atp[c]';'cmp[c]';'damp[c]';'dcmp[c]';'dgmp[c]';...
                'dtmp[c]';'ergst[c]';'gly[c]';'glycogen[c]';'gmp[c]';...
                'ala_L[c]';'arg_L[c]';'asn_L[c]';'asp_L[c]';'cys_L[c]';...
                'glu_L[c]';'gln_L[c]';'his_L[c]';'ile_L[c]';'leu_L[c]';...
                'lys_L[c]';'met_L[c]';'phe_L[c]';'pro_L[c]';'ser_L[c]';...
                'thr_L[c]';'trp_L[c]';'tyr_L[c]';'val_L[c]';...
                'mannan[c]';'pa_SC[c]';'pc_SC[c]';'pe_SC[c]';...
                'ps_SC[c]';'so4[c]';'triglyc_SC[c]';'ump[c]';...
                'zymst[c]';'adp[c]';'pi[c]';}, ... %new mets 
                {'biomass_published';}, ... %rxn id
                [-1.1348;-0.0053;-0.0234;-0.046;-59.276;-0.0447;...
                -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
                -0.5185;-0.046;-0.4588;-0.1607;-0.1017;-0.2975;...
                -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
                -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
                -0.0284;-0.102;-0.2646;-0.8079;-0.0006;-0.006;...
                -0.0045;-0.0017;-0.02;-0.0066;-0.0599;-0.0015;...
                59.276;59.305;]); %stoichiometric coefficients

        case {'ito977_cobra_compatible'}
            changed_model=changeRxnMets(model,...
                {'m160';'m584';'m339';'m340';'m358';'m618';'m621';...
                'm624';'m627';'m682';'m683';'m415';'m440';'m442';...
                'm444';'m447';'m451';'m457';'m458';'m461';'m466';...
                'm469';'m471';'m473';'m476';'m478';'m481';'m483';...
                'm485';'m487';'m489';'m732';'m816';'m562';'m724';...
                'm335';'m600';'m768';}, ... %mets to change
                {'m160';'m174';'m584';'m339';'m340';'m358';'m618';...
                'm621';'m624';'m627';'m662';'m682';'m683';'m415';...
                'm440';'m442';'m444';'m447';'m451';'m457';'m458';...
                'm461';'m466';'m469';'m471';'m473';'m476';'m478';...
                'm481';'m483';'m485';'m487';'m489';'m732';'m769';...
                'm772';'m773';'m774';'m816';'m884';'m562';'m894';...
                'm335';'m600';'m768';}, ... %new mets
                {'CBIOMASS';}, ... %rxn id
                [-1.1348;-0.0053;-0.0234;-0.0460;-59.276;-0.0447;...
                -0.0036;-0.0024;-0.0024;-0.0036;-0.0007;-0.2904;...
                -0.5185;-0.0460;-0.4588;-0.1607;-0.1017;-0.2975;...
                -0.0066;-0.3018;-0.1054;-0.0663;-0.1927;-0.2964;...
                -0.2862;-0.0507;-0.1339;-0.1647;-0.1854;-0.1914;...
                -0.0284;-0.1020;-0.2646;-0.8079;-0.0006;-0.0060;...
                -0.0045;-0.0017;-0.0200;-0.0066;-0.0599;-0.0015;...
                59.276;1;59.3050;]); %stoichiometric coefficients

        otherwise
            error('Sorry, this model is not currently supported.')
    end

    %% create model with complete medium for blocked reaction analysis
    %(all exchange reactions allowed to carry flux)
    
     switch lower(model.description)
        case {'iff708_valid_modified.xml'}
            
            uptake_rxn_ids = {'ZYMSTxtI';'XANxtI';'URIxtI';'UREAxtI';'URAxtI';...
                'THYxtI';'DTxtI';'THMxtI';'SLFxtI';'SUCxtI';'SUCCxtI';...
                'C180xtI';'SPRMxtI';'SORxtI';'NAxtI';'MMETxtI';'SAMxtI';...
                'RFLAVxtI';'PYRxtI';'KxtI';'PIMExtI';'PIxtI';'PEPTxtI';...
                'C160xtI';'O2xtI';'OGTxtI';'OPEPxtI';'NMNxtI';'NH3xtI';...
                'C140xtI';'MIxtI';'MTHNxtI';'MELIxtI';'MLTxtI';'MALxtI';...
                'VALxtI';'TYRxtI';'TRPxtI';'THRxtI';'SERxtI';'PROxtI';...
                'PHExtI';'ORNxtI';'METxtI';'LYSxtI';'LEUxtI';'ILExtI';'HISxtI';...
                'GLNxtI';'GLUxtI';'GLTxtI';'CYSxtI';'ASPxtI';'ASNxtI';'ARGxtI';...
                'ALAxtI';'INSxtI';'HYXNxtI';'GSNxtI';'GNxtI';'GLALxtI';...
                'GLYxtI';'GLxtI';'GLAMxtI';'GABAxtI';'FUMxtI';'FORxtI';'ETHxtI';...
                'ERGOxtI';'DTTPxtI';'RIBxtI';'RMNxtI';'MNTxtI';'DIPEPxtI';...
                'GA6PxtI';'GLACxtI';'FRUxtI';'DUxtI';'DINxtI';'DGxtI';'DCxtI';...
                'DAxtI';'ARABxtI';'CYTSxtI';'CYTDxtI';'CO2xtI';'CITxtI';...
                'CHOxtI';'BTxtI';'BMxtI';'FUCxtI';'MANxtI';'GLCxtI';'TRExtI';...
                'ATNxtI';'PAPxtI';'ADNxtI';'ADxtI';'ACxtI';'ACALxtI';'AONAxtI';...
                'DANNAxtI';'AKGxtI';'PNTOxtI';'LACxtI';};

            excretion_rxn_ids = {'ZYMSTxtO';'XANxtO';'URIxtO';'UREAxtO';...
                'URAxtO';'THYxtO';'DTxtO';'THMxtO';'SLFxtO';'SUCxtO';'SUCCxtO';...
                'C180xtO';'SPRMxtO';'SORxtO';'NAxtO';'MMETxtO';'SAMxtO';...
                'RFLAVxtO';'PYRxtO';'KxtO';'PIMExtO';'PIxtO';'PEPTxtO';...
                'C160xtO';'O2xtO';'OGTxtO';'OPEPxtO';'NMNxtO';'NH3xtO';...
                'C140xtO';'MIxtO';'MTHNxtO';'MELIxtO';'MLTxtO';'MALxtO';...
                'VALxtO';'TYRxtO';'TRPxtO';'THRxtO';'SERxtO';'PROxtO';...
                'PHExtO';'ORNxtO';'METxtO';'LYSxtO';'LEUxtO';'ILExtO';'HISxtO';...
                'GLNxtO';'GLUxtO';'GLTxtO';'CYSxtO';'ASPxtO';'ASNxtO';'ARGxtO';...
                'ALAxtO';'INSxtO';'HYXNxtO';'GSNxtO';'GNxtO';'GLALxtO';...
                'GLYxtO';'GLxtO';'GLAMxtO';'GABAxtO';'FUMxtO';'FORxtO';'ETHxtO';...
                'ERGOxtO';'DTTPxtO';'RIBxtO';'RMNxtO';'MNTxtO';'DIPEPxtO';...
                'GA6PxtO';'GLACxtO';'FRUxtO';'DUxtO';'DINxtO';'DGxtO';'DCxtO';...
                'DAxtO';'ARABxtO';'CYTSxtO';'CYTDxtO';'CO2xtO';'CITxtO';...
                'CHOxtO';'BTxtO';'FUCxtO';'MANxtO';'GLCxtO';'TRExtO';'ATNxtO';...
                'PAPxtO';'ADNxtO';'ADxtO';'ACxtO';'ACALxtO';'AONAxtO';...
                'DANNAxtO';'AKGxtO';'PNTOxtO';'LACxtO';'BMxtO';};

            model_maximal = model;
            
            uptake_rxn_indexes = findRxnIDs(model_maximal, uptake_rxn_ids);
            excretion_rxn_indexes = findRxnIDs(model_maximal, ...
                excretion_rxn_ids);

            model_maximal.lb(uptake_rxn_indexes) = 0;
            model_maximal.ub(uptake_rxn_indexes) = 1000;
            model_maximal.lb(excretion_rxn_indexes) = 0;
            model_maximal.ub(excretion_rxn_indexes) = 1000;
            
            model_maximal_changed = changed_model;
            uptake_rxn_indexes = findRxnIDs(model_maximal_changed, ...
                uptake_rxn_ids);
            excretion_rxn_indexes = findRxnIDs(model_maximal_changed, ...
                excretion_rxn_ids);

            model_maximal_changed.lb(uptake_rxn_indexes) = 0;
            model_maximal_changed.ub(uptake_rxn_indexes) = 1000;
            model_maximal_changed.lb(excretion_rxn_indexes) = 0;
            model_maximal_changed.ub(excretion_rxn_indexes) = 1000;
            
        case {'iin800_cobra'}
            uptake_rxn_ids = {'44DIMZYMSTxtI';'ACALxtI';'ACxtI';'ADNxtI';...
                'ADxtI';'AKGxtI';'ALAVxtI';'ALAxtI';'AMGxtI';'AONAxtI';...
                'ARABxtI';'ARGxtI';'ASNxtI';'ASPxtI';'ATNxtI';'ATTxtI';...
                'BTxtI';'C100xtI';'C120xtI';'C140xtI';'C141xtI';...
                'C160xtI';'C161xtI';'C180xtI';'C181xtI';'C24xtI';'C26xtI';...
                'CARxtI';'CHOxtI';'CITxtI';'CO2xtI';'CYSxtI';'CYTDxtI';...
                'CYTSxtI';'DANNAxtI';'DAxtI';'DCxtI';'DGxtI';'DINxtI';...
                'DIPEPxtI';'DTTPxtI';'DTxtI';'DUxtI';'EPISTxtI';...
                'ERG572224xtI';'ERG722xtI';'ERGOSTxtI';'ETHxtI';...
                'FCOSTxtI';'FORxtI';'FRUxtI';'FUCxtI';'FUMxtI';'GA6PxtI';...
                'GABAxtI';'GLACxtI';'GLALxtI';'GLAMxtI';'GLCxtI';'GLNxtI';...
                'GLTxtI';'GLUxtI';'GLxtI';'GLYxtI';'GNxtI';'GROPCxtI';...
                'GROPIxtI';'GSNxtI';'HEXTI';'HISxtI';'HYXNxtI';'ILExtI';...
                'INSxtI';'KxtI';'LACxtI';'LANOSTxtI';'LEUxtI';'LYSxtI';...
                'MALxtI';'MANxtI';'MELIxtI';'METxtI';'MIxtI';'MLTxtI';...
                'MMETxtI';'MNTxtI';'MTHNxtI';'NAGxtI';'NAxtI';'NH3xtI';...
                'NMNxtI';'O2xtI';'OGTxtI';'OPEPxtI';'ORNxtI';'PAPxtI';...
                'PEPTxtI';'PHExtI';'PIMExtI';'PIxtI';'PNTOxtI';'PROxtI';...
                'PTRSCxtI';'PYRxtI';'RFLAVxtI';'RIBxtI';'RMNxtI';'SAMxtI';...
                'SERxtI';'SLFxtI';'SORxtI';'SPRMDxtI';'SPRMxtI';'SUCCxtI';...
                'SUCxtI';'THMxtI';'THRxtI';'THYxtI';'TRExtI';'TRPxtI';...
                'TYRxtI';'URAxtI';'UREAxtI';'URIxtI';'VALxtI';'VB6xtI';...
                'XANxtI';'XTSINExtI';'XYLxtI';'ZYMSTxtI';}; %except biomass! BMxtI

            excretion_rxn_ids = {'44DIMZYMSTxtO';'ACALxtO';'ACxtO';...
                'ADNxtO';'ADxtO';'AKGxtO';'ALAVxtO';'ALAxtO';'AMGxtO';...
                'AONAxtO';'ARABxtO';'ARGxtO';'ASNxtO';'ASPxtO';'ATNxtO';...
                'ATTxtO';'BMxtO';'BTxtO';'C100xtO';'C120xtO';'C140xtO';...
                'C141xtO';'C160xtO';'C161xtO';'C180xtO';'C181xtO';...
                'C24xtO';'C26xtO';'CARxtO';'CHOxtO';'CITxtO';'CO2xtO';...
                'CYSxtO';'CYTDxtO';'CYTSxtO';'DANNAxtO';'DAxtO';'DCxtO';...
                'DGxtO';'DINxtO';'DIPEPxtO';'DTTPxtO';'DTxtO';'DUxtO';...
                'EPISTxtO';'ERG572224xtO';'ERG722xtO';'ERGOSTxtO';...
                'ETHxtO';'FCOSTxtO';'FORxtO';'FRUxtO';'FUCxtO';'FUMxtO';...
                'GA6PxtO';'GABAxtO';'GLACxtO';'GLALxtO';'GLAMxtO';...
                'GLCxtO';'GLNxtO';'GLTxtO';'GLUxtO';'GLxtO';'GLYxtO';...
                'GNxtO';'GROPCxtO';'GROPIxtO';'GSNxtO';'HEXTO';'HISxtO';...
                'HYXNxtO';'ILExtO';'INSxtO';'KxtO';'LACxtO';'LANOSTxtO';...
                'LEUxtO';'LYSxtO';'MALxtO';'MANxtO';'MELIxtO';'METxtO';...
                'MIxtO';'MLTxtO';'MMETxtO';'MNTxtO';'MTHNxtO';'NAGxtO';...
                'NAxtO';'NH3xtO';'NMNxtO';'O2xtO';'OGTxtO';'OPEPxtO';...
                'ORNxtO';'PAPxtO';'PEPTxtO';'PHExtO';'PIMExtO';'PIxtO';...
                'PNTOxtO';'PROxtO';'PTRSCxtO';'PYRxtO';'RFLAVxtO';...
                'RIBxtO';'RMNxtO';'SAMxtO';'SERxtO';'SLFxtO';'SORxtO';...
                'SPRMDxtO';'SPRMxtO';'SUCCxtO';'SUCxtO';'THMxtO';'THRxtO';...
                'THYxtO';'TRExtO';'TRPxtO';'TYRxtO';'URAxtO';'UREAxtO';...
                'URIxtO';'VALxtO';'VB6xtO';'XANxtO';'XTSINExtO';'XYLxtO';...
                'ZYMSTxtO';};
            
            model_maximal = model;
            
            uptake_rxn_indexes = findRxnIDs(model_maximal, uptake_rxn_ids);
            excretion_rxn_indexes = findRxnIDs(model_maximal, ...
                excretion_rxn_ids);

            model_maximal.lb(uptake_rxn_indexes) = 0;
            model_maximal.ub(uptake_rxn_indexes) = 1000;
            model_maximal.lb(excretion_rxn_indexes) = 0;
            model_maximal.ub(excretion_rxn_indexes) = 1000;
    
            model_maximal_changed = changed_model;
            uptake_rxn_indexes = findRxnIDs(model_maximal_changed, ...
                uptake_rxn_ids);
            excretion_rxn_indexes = findRxnIDs(model_maximal_changed, ...
                excretion_rxn_ids);

            model_maximal_changed.lb(uptake_rxn_indexes) = 0;
            model_maximal_changed.ub(uptake_rxn_indexes) = 1000;
            model_maximal_changed.lb(excretion_rxn_indexes) = 0;
            model_maximal_changed.ub(excretion_rxn_indexes) = 1000;
            
        case {'iin800.xml'}
            uptake_rxn_ids = {'44DIMZYMSTxtI';'ACALxtI';'ACxtI';'ADNxtI';...
                'ADxtI';'AKGxtI';'ALAVxtI';'ALAxtI';'AMGxtI';'AONAxtI';...
                'ARABxtI';'ARGxtI';'ASNxtI';'ASPxtI';'ATNxtI';'ATTxtI';...
                'BTxtI';'C100xtI';'C120xtI';'C140xtI';'C141xtI';...
                'C160xtI';'C161xtI';'C180xtI';'C181xtI';'C24xtI';'C26xtI';...
                'CARxtI';'CHOxtI';'CITxtI';'CO2xtI';'CYSxtI';'CYTDxtI';...
                'CYTSxtI';'DANNAxtI';'DAxtI';'DCxtI';'DGxtI';'DINxtI';...
                'DIPEPxtI';'DTTPxtI';'DTxtI';'DUxtI';'EPISTxtI';...
                'ERG572224xtI';'ERG722xtI';'ERGOSTxtI';'ETHxtI';...
                'FCOSTxtI';'FORxtI';'FRUxtI';'FUCxtI';'FUMxtI';'GA6PxtI';...
                'GABAxtI';'GLACxtI';'GLALxtI';'GLAMxtI';'GLCxtI';'GLNxtI';...
                'GLTxtI';'GLUxtI';'GLxtI';'GLYxtI';'GNxtI';'GROPCxtI';...
                'GROPIxtI';'GSNxtI';'HEXTI';'HISxtI';'HYXNxtI';'ILExtI';...
                'INSxtI';'KxtI';'LACxtI';'LANOSTxtI';'LEUxtI';'LYSxtI';...
                'MALxtI';'MANxtI';'MELIxtI';'METxtI';'MIxtI';'MLTxtI';...
                'MMETxtI';'MNTxtI';'MTHNxtI';'NAGxtI';'NAxtI';'NH3xtI';...
                'NMNxtI';'O2xtI';'OGTxtI';'OPEPxtI';'ORNxtI';'PAPxtI';...
                'PEPTxtI';'PHExtI';'PIMExtI';'PIxtI';'PNTOxtI';'PROxtI';...
                'PTRSCxtI';'PYRxtI';'RFLAVxtI';'RIBxtI';'RMNxtI';'SAMxtI';...
                'SERxtI';'SLFxtI';'SORxtI';'SPRMDxtI';'SPRMxtI';'SUCCxtI';...
                'SUCxtI';'THMxtI';'THRxtI';'THYxtI';'TRExtI';'TRPxtI';...
                'TYRxtI';'URAxtI';'UREAxtI';'URIxtI';'VALxtI';'VB6xtI';...
                'XANxtI';'XTSINExtI';'XYLxtI';'ZYMSTxtI';}; %except biomass! BMxtI

            excretion_rxn_ids = {'44DIMZYMSTxtO';'ACALxtO';'ACxtO';...
                'ADNxtO';'ADxtO';'AKGxtO';'ALAVxtO';'ALAxtO';'AMGxtO';...
                'AONAxtO';'ARABxtO';'ARGxtO';'ASNxtO';'ASPxtO';'ATNxtO';...
                'ATTxtO';'BMxtO';'BTxtO';'C100xtO';'C120xtO';'C140xtO';...
                'C141xtO';'C160xtO';'C161xtO';'C180xtO';'C181xtO';...
                'C24xtO';'C26xtO';'CARxtO';'CHOxtO';'CITxtO';'CO2xtO';...
                'CYSxtO';'CYTDxtO';'CYTSxtO';'DANNAxtO';'DAxtO';'DCxtO';...
                'DGxtO';'DINxtO';'DIPEPxtO';'DTTPxtO';'DTxtO';'DUxtO';...
                'EPISTxtO';'ERG572224xtO';'ERG722xtO';'ERGOSTxtO';...
                'ETHxtO';'FCOSTxtO';'FORxtO';'FRUxtO';'FUCxtO';'FUMxtO';...
                'GA6PxtO';'GABAxtO';'GLACxtO';'GLALxtO';'GLAMxtO';...
                'GLCxtO';'GLNxtO';'GLTxtO';'GLUxtO';'GLxtO';'GLYxtO';...
                'GNxtO';'GROPCxtO';'GROPIxtO';'GSNxtO';'HEXTO';'HISxtO';...
                'HYXNxtO';'ILExtO';'INSxtO';'KxtO';'LACxtO';'LANOSTxtO';...
                'LEUxtO';'LYSxtO';'MALxtO';'MANxtO';'MELIxtO';'METxtO';...
                'MIxtO';'MLTxtO';'MMETxtO';'MNTxtO';'MTHNxtO';'NAGxtO';...
                'NAxtO';'NH3xtO';'NMNxtO';'O2xtO';'OGTxtO';'OPEPxtO';...
                'ORNxtO';'PAPxtO';'PEPTxtO';'PHExtO';'PIMExtO';'PIxtO';...
                'PNTOxtO';'PROxtO';'PTRSCxtO';'PYRxtO';'RFLAVxtO';...
                'RIBxtO';'RMNxtO';'SAMxtO';'SERxtO';'SLFxtO';'SORxtO';...
                'SPRMDxtO';'SPRMxtO';'SUCCxtO';'SUCxtO';'THMxtO';'THRxtO';...
                'THYxtO';'TRExtO';'TRPxtO';'TYRxtO';'URAxtO';'UREAxtO';...
                'URIxtO';'VALxtO';'VB6xtO';'XANxtO';'XTSINExtO';'XYLxtO';...
                'ZYMSTxtO';};
            
            model_maximal = model;
            
            uptake_rxn_indexes = findRxnIDs(model_maximal, uptake_rxn_ids);
            excretion_rxn_indexes = findRxnIDs(model_maximal, ...
                excretion_rxn_ids);

            model_maximal.lb(uptake_rxn_indexes) = 0;
            model_maximal.ub(uptake_rxn_indexes) = 1000;
            model_maximal.lb(excretion_rxn_indexes) = 0;
            model_maximal.ub(excretion_rxn_indexes) = 1000;
            
            model_maximal_changed = changed_model;
            uptake_rxn_indexes = findRxnIDs(model_maximal_changed, ...
                uptake_rxn_ids);
            excretion_rxn_indexes = findRxnIDs(model_maximal_changed, ...
                excretion_rxn_ids);

            model_maximal_changed.lb(uptake_rxn_indexes) = 0;
            model_maximal_changed.ub(uptake_rxn_indexes) = 1000;
            model_maximal_changed.lb(excretion_rxn_indexes) = 0;
            model_maximal_changed.ub(excretion_rxn_indexes) = 1000;
                        
        case {'ito977_cobra_compatible'}
           
            uptake_rxn_ids = {'2MBACxtI';'2MBALDxtI';'44DIMZYMSTxtI';...
                'ACALxtI';'ACxtI';'ADNxtI';'ADxtI';'AKGxtI';'ALAVxtI';'ALAxtI';...
                'AMGxtI';'AONAxtI';'ARABxtI';'ARGxtI';'ASNxtI';'ASPxtI';...
                'ATNxtI';'ATTxtI';'BMxtI';'BTxtI';'C100xtI';'C120xtI';...
                'C140xtI';'C141xtI';'C160xtI';'C161xtI';'C180xtI';'C181xtI';...
                'C24xtI';'C26xtI';'CARxtI';'CHOxtI';'CITxtI';'CO2xtI';'CYSxtI';...
                'CYTDxtI';'CYTSxtI';'DANNAxtI';'DAxtI';'DCxtI';'DGxtI';...
                'DINxtI';'DIPEPxtI';'DTTPxtI';'DTxtI';'DUxtI';'EPISTxtI';...
                'ERG572224xtI';'ERG722xtI';'ERGOSTxtI';'ETHAxtI';'ETHxtI';...
                'FCOSTxtI';'FORxtI';'FRUxtI';'FUCxtI';'FUMxtI';'GA6PxtI';...
                'GABAxtI';'GLACxtI';'GLALxtI';'GLAMxtI';'GLCxtI';'GLNxtI';...
                'GLTxtI';'GLUxtI';'GLxtI';'GLYxtI';'GNxtI';'GROPCxtI';...
                'GROPIxtI';'GSNxtI';'HEXTI';'HISxtI';'HYXNxtI';'ILExtI';...
                'INSxtI';'KxtI';'LACxtI';'LANOSTxtI';'LEUxtI';'LYSxtI';...
                'MALxtI';'MANxtI';'MELIxtI';'METxtI';'MIxtI';'MLTxtI';...
                'MMETxtI';'MNTxtI';'MTHNxtI';'NAGxtI';'NAxtI';'NH3xtI';...
                'NMNxtI';'O2xtI';'OGTxtI';'OPEPxtI';'ORNxtI';'PAPxtI';...
                'PEPTxtI';'PHExtI';'PIMExtI';'PIxtI';'PNTOxtI';'PROxtI';...
                'PTRSCxtI';'PYRxtI';'RFLAVxtI';'RIBxtI';'RMNxtI';'SAMxtI';...
                'SERxtI';'SLFxtI';'SORxtI';'SPRMDxtI';'SPRMxtI';'SUCCxtI';...
                'SUCxtI';'THMxtI';'THRxtI';'THYxtI';'TRExtI';'TRPxtI';'TYRxtI';...
                'URAxtI';'UREAxtI';'URIxtI';'VALxtI';'VB6xtI';'XANxtI';...
                'XTSINExtI';'XYLxtI';'ZYMSTxtI';'DSERxtI'};

            excretion_rxn_ids = {'2MBACxtO';'44DIMZYMSTxtO';'ACALxtO';'ACxtO';...
                'ADNxtO';'ADxtO';'AKGxtO';'ALAVxtO';'ALAxtO';'AMGxtO';...
                'AONAxtO';'ARABxtO';'ARGxtO';'ASNxtO';'ASPxtO';'ATNxtO';...
                'ATTxtO';'BMxtO';'BTxtO';'C100xtO';'C120xtO';'C140xtO';...
                'C141xtO';'C160xtO';'C161xtO';'C180xtO';'C181xtO';'C24xtO';...
                'C26xtO';'CARxtO';'CHOxtO';'CITxtO';'CO2xtO';'CYSxtO';...
                'CYTDxtO';'CYTSxtO';'DANNAxtO';'DAxtO';'DCxtO';'DGxtO';...
                'DINxtO';'DIPEPxtO';'DTTPxtO';'DTxtO';'DUxtO';'EPISTxtO';...
                'ERG572224xtO';'ERG722xtO';'ERGOSTxtO';'ETHxtO';'FCOSTxtO';...
                'FORxtO';'FRUxtO';'FUCxtO';'FUMxtO';'GA6PxtO';'GABAxtO';...
                'GLACxtO';'GLALxtO';'GLAMxtO';'GLCxtO';'GLNxtO';'GLTxtO';...
                'GLUxtO';'GLxtO';'GLYxtO';'GNxtO';'GROPCxtO';'GROPIxtO';...
                'GSNxtO';'HEXTO';'HISxtO';'HYXNxtO';'ILExtO';'INSxtO';'KxtO';...
                'LACxtO';'LANOSTxtO';'LEUxtO';'LYSxtO';'MALxtO';'MANxtO';...
                'MELIxtO';'METxtO';'MIxtO';'MLTxtO';'MMETxtO';'MNTxtO';...
                'MTHNxtO';'NAGxtO';'NAxtO';'NH3xtO';'NMNxtO';'O2xtO';'OGTxtO';...
                'OPEPxtO';'ORNxtO';'PAPxtO';'PEPTxtO';'PHExtO';'PIMExtO';...
                'PIxtO';'PNTOxtO';'PROxtO';'PTRSCxtO';'PYRxtO';'RFLAVxtO';...
                'RIBxtO';'RMNxtO';'SAMxtO';'SERxtO';'SLFxtO';'SORxtO';...
                'SPRMDxtO';'SPRMxtO';'SUCCxtO';'SUCxtO';'THMxtO';'THRxtO';...
                'THYxtO';'TRExtO';'TRPxtO';'TYRxtO';'URAxtO';'UREAxtO';...
                'URIxtO';'VALxtO';'VB6xtO';'XANxtO';'XTSINExtO';'XYLxtO';...
                'ZYMSTxtO';'DSERxtO'};
            
            model_maximal = model;
            uptake_rxn_indexes = findRxnIDs(model_maximal, uptake_rxn_ids);
            excretion_rxn_indexes = findRxnIDs(model_maximal, ...
                excretion_rxn_ids);

            model_maximal.lb(uptake_rxn_indexes) = 0;
            model_maximal.ub(uptake_rxn_indexes) = 1000;
            model_maximal.lb(excretion_rxn_indexes) = 0;
            model_maximal.ub(excretion_rxn_indexes) = 1000;
            
            model_maximal_changed = changed_model;
            uptake_rxn_indexes = findRxnIDs(model_maximal_changed, ...
                uptake_rxn_ids);
            excretion_rxn_indexes = findRxnIDs(model_maximal_changed, ...
                excretion_rxn_ids);

            model_maximal_changed.lb(uptake_rxn_indexes) = 0;
            model_maximal_changed.ub(uptake_rxn_indexes) = 1000;
            model_maximal_changed.lb(excretion_rxn_indexes) = 0;
            model_maximal_changed.ub(excretion_rxn_indexes) = 1000;
            
        otherwise
            exchangeRxns = findExcRxns(model);

            model_maximal = model;
            model_maximal.lb(exchangeRxns) = -1000;
            model_maximal.ub(exchangeRxns) = 1000;
            
            exchangeRxns = findExcRxns(changed_model);
            model_maximal_changed = changed_model;
            model_maximal_changed.lb(exchangeRxns) = -1000;
            model_maximal_changed.ub(exchangeRxns) = 1000;
     end
     
    %% find dead end metabolites
    
    fprintf('\n%s\n','Checking for dead end metabolites...');

    deadEnds = detectDeadEnds(model);
    
    fprintf('\t%s%d%s%.2f%s\n','Number of dead end metabolites: ', ...
        length(deadEnds), ' (', ...
        length(deadEnds)/length(model.mets)*100, '%)');
        
    results.deadEnds = deadEnds;
        
    %% find blocked reactions (cannot carry any flux per FVA)

    fprintf('\n%s\n','Checking for blocked reactions...');
    
    blockedReactions_iFF = findBlockedReaction_ks(model_maximal_changed);

    fprintf('\t%.0f\t(%.2f%%)\t%s\n',length(blockedReactions_iFF),...
        (100*length(blockedReactions_iFF)/length(model_maximal_changed.rxns)),...
        'blocked reactions with iFF biomass');
    
     blockedReactions_default = findBlockedReaction_ks(model_maximal);
     
    fprintf('\t%.0f\t(%.2f%%)\t%s\n',length(blockedReactions_default),...
        (100*length(blockedReactions_default)/length(model_maximal.rxns)),...
        'blocked reactions with default biomass');
    
    results.blockedReactions_iFF = blockedReactions_iFF;
    results.blockedReactions_default = blockedReactions_default;

    
end

%% required functions

function blockedReactions = findBlockedReaction_ks(model)
    % findBlockedReaction determines those reactions which cannot carry any
    % flux in the given simulation conditions.
    %
    % BlockedReaction = findBlockedReaction(model)
    %
    % INPUT
    %  model              COBRA model structure
    %
    % OUTPUT
    %  blockedReactions   List of blocked reactions
    %
    %
    % Ines Thiele 02/09
    % kieran: 15 aug 11
    % James Eddy: 19 Feb 13

    tol = 1e-10;
    [minMax(:,1),minMax(:,2)] = fluxVariability(model,0); %this has unpredictable errors...
    blocked = abs(minMax(:,1)) < tol & abs(minMax(:,2)) < tol;
    blockedReactions = model.rxns(blocked);
end